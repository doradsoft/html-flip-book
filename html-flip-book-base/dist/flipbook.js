/*! For license information please see flipbook.js.LICENSE.txt */
var t={168:(t,e,i)=>{var n;!function(s,r,o,a){var h,c=["","webkit","Moz","MS","ms","o"],u=r.createElement("div"),l="function",p=Math.round,f=Math.abs,d=Date.now;function v(t,e,i){return setTimeout(w(t,i),e)}function g(t,e,i){return!!Array.isArray(t)&&(m(t,i[e],i),!0)}function m(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==a)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function T(t,e,i){var n="DEPRECATED METHOD: "+e+"\n"+i+" AT \n";return function(){var e=new Error("get-stack-trace"),i=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=s.console&&(s.console.warn||s.console.log);return r&&r.call(s.console,n,i),t.apply(this,arguments)}}h="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==a&&null!==n)for(var s in n)n.hasOwnProperty(s)&&(e[s]=n[s])}return e}:Object.assign;var y=T((function(t,e,i){for(var n=Object.keys(e),s=0;s<n.length;)(!i||i&&t[n[s]]===a)&&(t[n[s]]=e[n[s]]),s++;return t}),"extend","Use `assign`."),b=T((function(t,e){return y(t,e,!0)}),"merge","Use `assign`.");function E(t,e,i){var n,s=e.prototype;(n=t.prototype=Object.create(s)).constructor=t,n._super=s,i&&h(n,i)}function w(t,e){return function(){return t.apply(e,arguments)}}function P(t,e){return typeof t==l?t.apply(e&&e[0]||a,e):t}function A(t,e){return t===a?e:t}function x(t,e,i){m(I(e),(function(e){t.addEventListener(e,i,!1)}))}function D(t,e,i){m(I(e),(function(e){t.removeEventListener(e,i,!1)}))}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function C(t,e){return t.indexOf(e)>-1}function I(t){return t.trim().split(/\s+/g)}function L(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function F(t){return Array.prototype.slice.call(t,0)}function R(t,e,i){for(var n=[],s=[],r=0;r<t.length;){var o=e?t[r][e]:t[r];L(s,o)<0&&n.push(t[r]),s[r]=o,r++}return i&&(n=e?n.sort((function(t,i){return t[e]>i[e]})):n.sort()),n}function M(t,e){for(var i,n,s=e[0].toUpperCase()+e.slice(1),r=0;r<c.length;){if((n=(i=c[r])?i+s:e)in t)return n;r++}return a}var k=1;function _(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||s}var N="ontouchstart"in s,O=M(s,"PointerEvent")!==a,X=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z="touch",Y="mouse",q=25,W=1,$=4,H=8,V=1,j=2,U=4,B=8,G=16,Z=j|U,J=B|G,K=Z|J,Q=["x","y"],tt=["clientX","clientY"];function et(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){P(t.options.enable,[t])&&i.handler(e)},this.init()}function it(t,e,i){var n=i.pointers.length,s=i.changedPointers.length,r=e&W&&n-s==0,o=e&($|H)&&n-s==0;i.isFirst=!!r,i.isFinal=!!o,r&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,s=n.length;i.firstInput||(i.firstInput=nt(e)),s>1&&!i.firstMultiple?i.firstMultiple=nt(e):1===s&&(i.firstMultiple=!1);var r=i.firstInput,o=i.firstMultiple,h=o?o.center:r.center,c=e.center=st(n);e.timeStamp=d(),e.deltaTime=e.timeStamp-r.timeStamp,e.angle=ht(h,c),e.distance=at(h,c),function(t,e){var i=e.center,n=t.offsetDelta||{},s=t.prevDelta||{},r=t.prevInput||{};e.eventType!==W&&r.eventType!==$||(s=t.prevDelta={x:r.deltaX||0,y:r.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=s.x+(i.x-n.x),e.deltaY=s.y+(i.y-n.y)}(i,e),e.offsetDirection=ot(e.deltaX,e.deltaY);var u,l,p=rt(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=p.x,e.overallVelocityY=p.y,e.overallVelocity=f(p.x)>f(p.y)?p.x:p.y,e.scale=o?(u=o.pointers,at((l=n)[0],l[1],tt)/at(u[0],u[1],tt)):1,e.rotation=o?function(t,e){return ht(e[1],e[0],tt)+ht(t[1],t[0],tt)}(o.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,s,r,o=t.lastInterval||e,h=e.timeStamp-o.timeStamp;if(e.eventType!=H&&(h>q||o.velocity===a)){var c=e.deltaX-o.deltaX,u=e.deltaY-o.deltaY,l=rt(h,c,u);n=l.x,s=l.y,i=f(l.x)>f(l.y)?l.x:l.y,r=ot(c,u),t.lastInterval=e}else i=o.velocity,n=o.velocityX,s=o.velocityY,r=o.direction;e.velocity=i,e.velocityX=n,e.velocityY=s,e.direction=r}(i,e);var v=t.element;S(e.srcEvent.target,v)&&(v=e.srcEvent.target),e.target=v}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function nt(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:p(t.pointers[i].clientX),clientY:p(t.pointers[i].clientY)},i++;return{timeStamp:d(),pointers:e,center:st(e),deltaX:t.deltaX,deltaY:t.deltaY}}function st(t){var e=t.length;if(1===e)return{x:p(t[0].clientX),y:p(t[0].clientY)};for(var i=0,n=0,s=0;s<e;)i+=t[s].clientX,n+=t[s].clientY,s++;return{x:p(i/e),y:p(n/e)}}function rt(t,e,i){return{x:e/t||0,y:i/t||0}}function ot(t,e){return t===e?V:f(t)>=f(e)?t<0?j:U:e<0?B:G}function at(t,e,i){i||(i=Q);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return Math.sqrt(n*n+s*s)}function ht(t,e,i){i||(i=Q);var n=e[i[0]]-t[i[0]],s=e[i[1]]-t[i[1]];return 180*Math.atan2(s,n)/Math.PI}et.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(_(this.element),this.evWin,this.domHandler)}};var ct={mousedown:W,mousemove:2,mouseup:$},ut="mousedown",lt="mousemove mouseup";function pt(){this.evEl=ut,this.evWin=lt,this.pressed=!1,et.apply(this,arguments)}E(pt,et,{handler:function(t){var e=ct[t.type];e&W&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=$),this.pressed&&(e&$&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Y,srcEvent:t}))}});var ft={pointerdown:W,pointermove:2,pointerup:$,pointercancel:H,pointerout:H},dt={2:z,3:"pen",4:Y,5:"kinect"},vt="pointerdown",gt="pointermove pointerup pointercancel";function mt(){this.evEl=vt,this.evWin=gt,et.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}s.MSPointerEvent&&!s.PointerEvent&&(vt="MSPointerDown",gt="MSPointerMove MSPointerUp MSPointerCancel"),E(mt,et,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),s=ft[n],r=dt[t.pointerType]||t.pointerType,o=r==z,a=L(e,t.pointerId,"pointerId");s&W&&(0===t.button||o)?a<0&&(e.push(t),a=e.length-1):s&($|H)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,s,{pointers:e,changedPointers:[t],pointerType:r,srcEvent:t}),i&&e.splice(a,1))}});var Tt={touchstart:W,touchmove:2,touchend:$,touchcancel:H};function yt(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,et.apply(this,arguments)}function bt(t,e){var i=F(t.touches),n=F(t.changedTouches);return e&($|H)&&(i=R(i.concat(n),"identifier",!0)),[i,n]}E(yt,et,{handler:function(t){var e=Tt[t.type];if(e===W&&(this.started=!0),this.started){var i=bt.call(this,t,e);e&($|H)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:t})}}});var Et={touchstart:W,touchmove:2,touchend:$,touchcancel:H},wt="touchstart touchmove touchend touchcancel";function Pt(){this.evTarget=wt,this.targetIds={},et.apply(this,arguments)}function At(t,e){var i=F(t.touches),n=this.targetIds;if(e&(2|W)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var s,r,o=F(t.changedTouches),a=[],h=this.target;if(r=i.filter((function(t){return S(t.target,h)})),e===W)for(s=0;s<r.length;)n[r[s].identifier]=!0,s++;for(s=0;s<o.length;)n[o[s].identifier]&&a.push(o[s]),e&($|H)&&delete n[o[s].identifier],s++;return a.length?[R(r.concat(a),"identifier",!0),a]:void 0}E(Pt,et,{handler:function(t){var e=Et[t.type],i=At.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:z,srcEvent:t})}});var xt=2500;function Dt(){et.apply(this,arguments);var t=w(this.handler,this);this.touch=new Pt(this.manager,t),this.mouse=new pt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function St(t,e){t&W?(this.primaryTouch=e.changedPointers[0].identifier,Ct.call(this,e)):t&($|H)&&Ct.call(this,e)}function Ct(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout((function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)}),xt)}}function It(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var s=this.lastTouches[n],r=Math.abs(e-s.x),o=Math.abs(i-s.y);if(r<=25&&o<=25)return!0}return!1}E(Dt,et,{handler:function(t,e,i){var n=i.pointerType==z,s=i.pointerType==Y;if(!(s&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)St.call(this,e,i);else if(s&&It.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Lt=M(u.style,"touchAction"),Ft=Lt!==a,Rt="compute",Mt="auto",kt="manipulation",_t="none",Nt="pan-x",Ot="pan-y",Xt=function(){if(!Ft)return!1;var t={},e=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){t[i]=!e||s.CSS.supports("touch-action",i)})),t}();function zt(t,e){this.manager=t,this.set(e)}zt.prototype={set:function(t){t==Rt&&(t=this.compute()),Ft&&this.manager.element.style&&Xt[t]&&(this.manager.element.style[Lt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){P(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(C(t,_t))return _t;var e=C(t,Nt),i=C(t,Ot);return e&&i?_t:e||i?e?Nt:Ot:C(t,kt)?kt:Mt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,s=C(n,_t)&&!Xt[_t],r=C(n,Ot)&&!Xt[Ot],o=C(n,Nt)&&!Xt[Nt];if(s){var a=1===t.pointers.length,h=t.distance<2,c=t.deltaTime<250;if(a&&h&&c)return}if(!o||!r)return s||r&&i&Z||o&&i&J?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Yt=1,qt=32;function Wt(t){this.options=h({},this.defaults,t||{}),this.id=k++,this.manager=null,this.options.enable=A(this.options.enable,!0),this.state=Yt,this.simultaneous={},this.requireFail=[]}function $t(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Ht(t){return t==G?"down":t==B?"up":t==j?"left":t==U?"right":""}function Vt(t,e){var i=e.manager;return i?i.get(t):t}function jt(){Wt.apply(this,arguments)}function Ut(){jt.apply(this,arguments),this.pX=null,this.pY=null}function Bt(){jt.apply(this,arguments)}function Gt(){Wt.apply(this,arguments),this._timer=null,this._input=null}function Zt(){jt.apply(this,arguments)}function Jt(){jt.apply(this,arguments)}function Kt(){Wt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Qt(t,e){return(e=e||{}).recognizers=A(e.recognizers,Qt.defaults.preset),new te(t,e)}function te(t,e){this.options=h({},Qt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(O?mt:X?Pt:N?Dt:pt))(this,it),this.touchAction=new zt(this,this.options.touchAction),ee(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ee(t,e){var i,n=t.element;n.style&&(m(t.options.cssProps,(function(s,r){i=M(n.style,r),e?(t.oldCssProps[i]=n.style[i],n.style[i]=s):n.style[i]=t.oldCssProps[i]||""})),e||(t.oldCssProps={}))}Wt.prototype={defaults:{},set:function(t){return h(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Vt(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Vt(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===L(e,t=Vt(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Vt(t,this);var e=L(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<8&&n(e.options.event+$t(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=8&&n(e.options.event+$t(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=qt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(qt|Yt)))return!1;t++}return!0},recognize:function(t){var e=h({},t);if(!P(this.options.enable,[this,e]))return this.reset(),void(this.state=qt);56&this.state&&(this.state=Yt),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},E(jt,Wt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=6&e,s=this.attrTest(t);return n&&(i&H||!s)?16|e:n||s?i&$?8|e:2&e?4|e:2:qt}}),E(Ut,jt,{defaults:{event:"pan",threshold:10,pointers:1,direction:K},getTouchAction:function(){var t=this.options.direction,e=[];return t&Z&&e.push(Ot),t&J&&e.push(Nt),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,s=t.direction,r=t.deltaX,o=t.deltaY;return s&e.direction||(e.direction&Z?(s=0===r?V:r<0?j:U,i=r!=this.pX,n=Math.abs(t.deltaX)):(s=0===o?V:o<0?B:G,i=o!=this.pY,n=Math.abs(t.deltaY))),t.direction=s,i&&n>e.threshold&&s&e.direction},attrTest:function(t){return jt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ht(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),E(Bt,jt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),E(Gt,Wt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Mt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&($|H)&&!s)this.reset();else if(t.eventType&W)this.reset(),this._timer=v((function(){this.state=8,this.tryEmit()}),e.time,this);else if(t.eventType&$)return 8;return qt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&t.eventType&$?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),E(Zt,jt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[_t]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),E(Jt,jt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Z|J,pointers:1},getTouchAction:function(){return Ut.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Z|J)?e=t.overallVelocity:i&Z?e=t.overallVelocityX:i&J&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&f(e)>this.options.velocity&&t.eventType&$},emit:function(t){var e=Ht(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),E(Kt,Wt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[kt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,s=t.deltaTime<e.time;if(this.reset(),t.eventType&W&&0===this.count)return this.failTimeout();if(n&&s&&i){if(t.eventType!=$)return this.failTimeout();var r=!this.pTime||t.timeStamp-this.pTime<e.interval,o=!this.pCenter||at(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,o&&r?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=v((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return qt},failTimeout:function(){return this._timer=v((function(){this.state=qt}),this.options.interval,this),qt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Qt.VERSION="2.0.7",Qt.defaults={domEvents:!1,touchAction:Rt,enable:!0,inputTarget:null,inputClass:null,preset:[[Zt,{enable:!1}],[Bt,{enable:!1},["rotate"]],[Jt,{direction:Z}],[Ut,{direction:Z},["swipe"]],[Kt],[Kt,{event:"doubletap",taps:2},["tap"]],[Gt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},te.prototype={set:function(t){return h(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,s=e.curRecognizer;(!s||s&&8&s.state)&&(s=e.curRecognizer=null);for(var r=0;r<n.length;)i=n[r],2===e.stopped||s&&i!=s&&!i.canRecognizeWith(s)?i.reset():i.recognize(t),!s&&14&i.state&&(s=e.curRecognizer=i),r++}},get:function(t){if(t instanceof Wt)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=L(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var i=this.handlers;return m(I(t),(function(t){i[t]=i[t]||[],i[t].push(e)})),this}},off:function(t,e){if(t!==a){var i=this.handlers;return m(I(t),(function(t){e?i[t]&&i[t].splice(L(i[t],e),1):delete i[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var i=r.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&ee(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(Qt,{INPUT_START:W,INPUT_MOVE:2,INPUT_END:$,INPUT_CANCEL:H,STATE_POSSIBLE:Yt,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:qt,DIRECTION_NONE:V,DIRECTION_LEFT:j,DIRECTION_RIGHT:U,DIRECTION_UP:B,DIRECTION_DOWN:G,DIRECTION_HORIZONTAL:Z,DIRECTION_VERTICAL:J,DIRECTION_ALL:K,Manager:te,Input:et,TouchAction:zt,TouchInput:Pt,MouseInput:pt,PointerEventInput:mt,TouchMouseInput:Dt,SingleTouchInput:yt,Recognizer:Wt,AttrRecognizer:jt,Tap:Kt,Pan:Ut,Swipe:Jt,Pinch:Bt,Rotate:Zt,Press:Gt,on:x,off:D,each:m,merge:b,extend:y,assign:h,inherit:E,bindFn:w,prefixed:M}),(void 0!==s?s:"undefined"!=typeof self?self:{}).Hammer=Qt,(n=function(){return Qt}.call(e,i,e,t))===a||(t.exports=n)}(window,document)},970:(t,e,i)=>{i.d(e,{A:()=>a});var n=i(645),s=i.n(n),r=i(278),o=i.n(r)()(s());o.push([t.id,".flipbook{height:100%;width:100%;overflow:hidden}.flipbook-debug-bar{position:absolute;bottom:0;left:0;width:100%;background-color:rgba(0,0,0,.5);color:#fff;padding:10px;box-sizing:border-box;display:flex;flex-wrap:wrap;justify-content:space-between;z-index:9999}",""]);const a=o},0:(t,e,i)=>{i.d(e,{A:()=>a});var n=i(645),s=i.n(n),r=i(278),o=i.n(r)()(s());o.push([t.id,".page{position:absolute;backface-visibility:hidden;transform-style:preserve-3d}.page>*{max-width:100%;max-height:100%;height:100%;width:100%;box-sizing:border-box}",""]);const a=o},278:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",n=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),n&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),n&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,n,s,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(n)for(var a=0;a<this.length;a++){var h=this[a][0];null!=h&&(o[h]=!0)}for(var c=0;c<t.length;c++){var u=[].concat(t[c]);n&&o[u[0]]||(void 0!==r&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=r),i&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=i):u[2]=i),s&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=s):u[4]="".concat(s)),e.push(u))}},e}},645:t=>{t.exports=function(t){return t[1]}},292:t=>{var e=[];function i(t){for(var i=-1,n=0;n<e.length;n++)if(e[n].identifier===t){i=n;break}return i}function n(t,n){for(var r={},o=[],a=0;a<t.length;a++){var h=t[a],c=n.base?h[0]+n.base:h[0],u=r[c]||0,l="".concat(c," ").concat(u);r[c]=u+1;var p=i(l),f={css:h[1],media:h[2],sourceMap:h[3],supports:h[4],layer:h[5]};if(-1!==p)e[p].references++,e[p].updater(f);else{var d=s(f,n);n.byIndex=a,e.splice(a,0,{identifier:l,updater:d,references:1})}o.push(l)}return o}function s(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,s){var r=n(t=t||[],s=s||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var a=i(r[o]);e[a].references--}for(var h=n(t,s),c=0;c<r.length;c++){var u=i(r[c]);0===e[u].references&&(e[u].updater(),e.splice(u,1))}r=h}}},383:t=>{var e={};t.exports=function(t,i){var n=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(i)}},88:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},884:(t,e,i)=>{t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},893:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var n="";i.supports&&(n+="@supports (".concat(i.supports,") {")),i.media&&(n+="@media ".concat(i.media," {"));var s=void 0!==i.layer;s&&(n+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),n+=i.css,s&&(n+="}"),i.media&&(n+="}"),i.supports&&(n+="}");var r=i.sourceMap;r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},997:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var r=e[n]={id:n,exports:{}};return t[n](r,r.exports,i),r.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nc=void 0;var n={};i.d(n,{$:()=>D});var s=i(292),r=i.n(s),o=i(893),a=i.n(o),h=i(383),c=i.n(h),u=i(884),l=i.n(u),p=i(88),f=i.n(p),d=i(997),v=i.n(d),g=i(0),m={};m.styleTagTransform=v(),m.setAttributes=l(),m.insert=c().bind(null,"head"),m.domAPI=a(),m.insertStyleElement=f(),r()(g.A,m),g.A&&g.A.locals&&g.A.locals;var T=i(970),y={};y.styleTagTransform=v(),y.setAttributes=l(),y.insert=c().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=f(),r()(T.A,y),T.A&&T.A.locals&&T.A.locals;var b,E=i(168),w=i.n(E);!function(t){t.Forward="Forward",t.Backward="Backward",t.None="None"}(b||(b={}));class P{index;pages;bookProperties;onTurned;currentAnimation=null;targetFlipPosition=null;wrappedFlipPosition;constructor(t,e,i,n,s){this.index=t,this.pages=e,this.bookProperties=n,this.onTurned=s,this.wrappedFlipPosition=i?1:0}get isTurned(){return 1===this.flipPosition}get isTurning(){return 0!==this.flipPosition}get isCover(){return this.isFirst||this.isLast}get isFirst(){return 0===this.index}get isLast(){return this.index===this.bookProperties.leavesCount-1}set flipPosition(t){this.wrappedFlipPosition=Math.max(0,Math.min(1,t))}get flipPosition(){return this.wrappedFlipPosition}async flipToPosition(t,e=225){return this.currentAnimation&&await this.currentAnimation,this.flipPosition===t?Promise.resolve():this.targetFlipPosition===t?this.currentAnimation??Promise.resolve():(this.targetFlipPosition=t,this.currentAnimation=new Promise((i=>{const n=this.flipPosition,s=180*Math.abs(t-n)/e*1e3,r=performance.now(),o=e=>{const a=e-r;if(a<0)return void requestAnimationFrame(o);const h=Math.min(a/s,1),c=n+h*(t-n);this.pages.forEach(((t,e)=>{const i=this.bookProperties.isLTR;if(t){const n=e%2+1==1,s=(n?i?c>.5?180-180*c:180*-c:c>.5?-(180-180*c):180*c:i?c<.5?180*-c:180-180*c:c<.5?180*c:-(180-180*c))+"deg",r=n?i?"100%":"-100%":"0px",o=n?c>.5?-1:1:c<.5?-1:1;t.style.transform=`translateX(${r})rotateY(${s})scaleX(${o})`,t.style.transformOrigin=n?i?"left":"right":i?"right":"left",t.style.zIndex=`${c>.5?t.dataset.pageIndex:this.bookProperties.pagesCount-t.dataset.pageIndex}`}})),this.flipPosition=Math.max(0,Math.min(1,c)),1!==this.flipPosition&&0!==this.flipPosition||this.onTurned(1===this.flipPosition?b.Forward:b.Backward),h<1?requestAnimationFrame(o):(this.currentAnimation=null,this.targetFlipPosition=null,i())};requestAnimationFrame(o)})),this.currentAnimation)}async efficientFlipToPosition(t,e=2e4){return function(t,e,i){var n,s=i||{},r=s.noTrailing,o=void 0!==r&&r,a=s.noLeading,h=void 0!==a&&a,c=s.debounceMode,u=void 0===c?void 0:c,l=!1,p=0;function f(){n&&clearTimeout(n)}function d(){for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];var a=this,c=Date.now()-p;function d(){p=Date.now(),e.apply(a,s)}function v(){n=void 0}l||(h||!u||n||d(),f(),void 0===u&&c>t?h?(p=Date.now(),o||(n=setTimeout(u?v:d,t))):d():!0!==o&&(n=setTimeout(u?v:d,void 0===u?t-c:t)))}return d.cancel=function(t){var e=(t||{}).upcomingOnly,i=void 0!==e&&e;f(),l=!i},d}(1,this.flipToPosition.bind(this))(t,e)}}class A{width;height;static from(t){return new A(t.width,t.height)}constructor(t,e){this.width=t,this.height=e}get value(){return this.width/this.height}}class x{width;height;aspectRatio;aspectRatioFit(t){const e=A.from(t).value;return this.aspectRatio.value>e?new x(this.height*e,this.height):new x(this.width,this.width/e)}constructor(t,e){this.width=t,this.height=e,this.aspectRatio=new A(t,e)}get asString(){return`${this.width}x${this.height}`}}class D{bookElement;pageElements=[];pagesCount;leafAspectRatio={width:2,height:3};coverAspectRatio={width:2.15,height:3.15};direction="ltr";onPageChanged;pageSemantics;leaves=[];currentLeaf=void 0;flipDirection=b.None;flipStartingPos=0;isDuringManualFlip=!1;flipDelta=0;isDuringAutoFlip=!1;touchStartingPos={x:0,y:0};prevVisiblePageIndices;get isLTR(){return"ltr"===this.direction}get isClosed(){return!this.currentOrTurningLeaves[0]}get isClosedInverted(){return!this.currentLeaves[1]}get currentLeaves(){let t=-1;for(let e=this.leaves.length-1;e>=0;e--){const i=this.leaves[e];if(i.isTurned){t=i.index+1;break}}return-1==t?[void 0,this.leaves[0]]:t==this.leaves.length?[this.leaves[t-1],void 0]:[this.leaves[t-1],this.leaves[t]]}get currentOrTurningLeaves(){let t=-1;for(let e=this.leaves.length-1;e>=0;e--){const i=this.leaves[e];if(i.isTurned||i.isTurning){t=i.index+1;break}}return-1==t?[void 0,this.leaves[0]]:t==this.leaves.length?[this.leaves[t-1],void 0]:[this.leaves[t-1],this.leaves[t]]}constructor(t){this.pagesCount=t.pagesCount,this.leafAspectRatio=t.leafAspectRatio||this.leafAspectRatio,this.coverAspectRatio=t.coverAspectRatio||this.coverAspectRatio,this.direction=t.direction||this.direction,this.pageSemantics=t.pageSemantics,this.onPageChanged=t.onPageChanged}render(t,e=!1){const i=document.querySelector(t);if(!i)throw new Error(`Couldn't find container with selector: ${t}`);this.bookElement=i,this.bookElement.classList.contains("flipbook")||this.bookElement.classList.add("flipbook");const n=i.querySelectorAll(".page");if(!n.length)throw new Error("No pages found in flipbook");this.pageElements=Array.from(n),this.leaves.splice(0,this.leaves.length);const s=Math.ceil(this.pagesCount/2),r=new x(this.bookElement.clientWidth/2,this.bookElement.clientHeight).aspectRatioFit(this.coverAspectRatio),o=new x(r.width*this.leafAspectRatio.width/this.coverAspectRatio.width,r.height*this.leafAspectRatio.height/this.coverAspectRatio.height);this.bookElement.style.perspective=2*Math.min(2*o.width,o.height)+"px",this.pageElements.forEach(((t,e)=>{t.style.width=`${o.width}px`,t.style.height=`${o.height}px`,t.style.zIndex=""+(this.pagesCount-e),t.dataset.pageIndex=e.toString(),t.style[this.isLTR?"left":"right"]=(i.clientWidth-2*o.width)/2+"px",t.style.top=(i.clientHeight-o.height)/2+"px",t.dataset.pageSemanticName=this.pageSemantics?.indexToSemanticName(e)??"",t.dataset.pageTitle=this.pageSemantics?.indexToTitle(e)??"";const n=Math.floor(e/2),r=(e+1)%2==1;t.classList.add(r?"odd":"even",...0===e?["current-page"]:[]),r?(t.style.transform=`translateX(${this.isLTR?"":"-"}100%)`,this.leaves[n]=new P(n,[t,void 0],!1,{isLTR:this.isLTR,leavesCount:s,pagesCount:this.pagesCount},(t=>{const i=t==b.Forward?e+2===this.pagesCount?[e+1]:[e+1,e+2]:0===e?[e]:[e-1,e];if(this.prevVisiblePageIndices&&this.prevVisiblePageIndices.length===i.length&&i.every(((t,e)=>t===this.prevVisiblePageIndices[e])))return;const n=this.prevVisiblePageIndices;this.prevVisiblePageIndices=i,this.onTurned(i,n)}))):(t.style.transform=`scaleX(-1)translateX(${this.isLTR?"-":""}100%)`,this.leaves[n].pages[1]=t)}));const a=new(w())(this.bookElement);a.on("panstart",this.onDragStart.bind(this)),a.on("panmove",this.onDragUpdate.bind(this)),a.on("panend",this.onDragEnd.bind(this)),this.bookElement.addEventListener("touchstart",this.handleTouchStart.bind(this),{passive:!1}),this.bookElement.addEventListener("touchmove",this.handleTouchMove.bind(this),{passive:!1}),e&&this.fillDebugBar()}fillDebugBar(){const t=document.createElement("div");t.className="flipbook-debug-bar",this.bookElement?.appendChild(t),setInterval((()=>{t.innerHTML=`\n          <div>Direction: ${this.isLTR?"LTR":"RTL"}</div>\n          <div>Current Leaf: ${this.currentLeaf?this.currentLeaf.index:"None"}</div>\n          <div>Flip dir: ${this.flipDirection}</div>\n          <div>Flip Δ: ${this.flipDelta}</div>\n          <div>Current Leaf Flip Position: ${this.currentLeaf?.flipPosition.toFixed(3)}</div>\n          <div>Is During Auto Flip: ${this.isDuringAutoFlip}</div>\n        `}),10)}onDragStart(t){if(console.log("drag start"),this.currentLeaf||this.isDuringAutoFlip)return this.flipDirection=b.None,void(this.flipStartingPos=0);this.flipStartingPos=t.center.x}onDragUpdate(t){if(console.log("drag update"),!this.isDuringAutoFlip&&!this.isDuringManualFlip){this.isDuringManualFlip=!0;try{const e=t.center.x;this.flipDelta=this.isLTR?this.flipStartingPos-e:e-this.flipStartingPos;const i=this.bookElement?.clientWidth??0;if(Math.abs(this.flipDelta)>i)return;if(0===this.flipDelta)return;switch(this.flipDirection=this.flipDirection!==b.None?this.flipDirection:this.flipDelta>0?b.Forward:b.Backward,this.flipDirection){case b.Forward:const t=this.flipDelta/i;if(t>1||this.flipDelta<0)return;if(!this.currentLeaf){if(this.isClosedInverted)return;this.currentLeaf=this.currentOrTurningLeaves[1]}this.currentLeaf.efficientFlipToPosition(t);break;case b.Backward:const e=1-Math.abs(this.flipDelta)/i;if(e<0||this.flipDelta>0)return;if(!this.currentLeaf){if(this.isClosed)return;this.currentLeaf=this.currentOrTurningLeaves[0]}this.currentLeaf.efficientFlipToPosition(e)}}finally{this.isDuringManualFlip=!1}}}async onDragEnd(t){if(console.log("drag end"),!this.currentLeaf||this.isDuringAutoFlip)return this.flipDirection=b.None,void(this.flipStartingPos=0);const e=1e3*t.velocityX;let i;switch(this.flipDirection){case b.Forward:i=(this.isLTR?e<-500:e>500)||this.currentLeaf.flipPosition>=.5?1:0;break;case b.Backward:i=(this.isLTR?e>500:e<-500)||this.currentLeaf.flipPosition<=.5?0:1;break;default:return}this.isDuringAutoFlip=!0,this.flipDirection=b.None,this.flipStartingPos=0,await this.currentLeaf.flipToPosition(i),this.isDuringAutoFlip=!1,this.currentLeaf=void 0}handleTouchStart=t=>{if(t.touches.length>1)return;const e=t.touches[0];this.touchStartingPos={x:e.pageX,y:e.pageY}};handleTouchMove=t=>{if(t.touches.length>1)return;const e=t.touches[0],i=e.pageX-this.touchStartingPos.x,n=e.pageY-this.touchStartingPos.y;Math.abs(i)>Math.abs(n)&&t.preventDefault()};onTurned(t,e){for(let i=0;i<this.pageElements.length;i++){const n=this.pageElements[i];(t.includes(i)?n.classList.add:e&&e.includes?n.classList.remove:()=>null).bind(n.classList)("current-page")}}jumpToPage(t){this.onPageChanged&&this.onPageChanged(t)}}var S=n.$;export{S as FlipBook};
